DB::Exception: Memory limit (for query) exceeded: would use 9.53 GiB (attempt to allocate chunk of 2147483648 bytes), maximum: 9.31 GiB: while executing 'FUNCTION arrayMap(__lambda_9 :: 6, arraySort(lambda(tuple(x, y), y), groupArray(act), groupArray(msg_milli_timestamp)) :: 13, arrayEnumerate(arraySort(lambda(tuple(x, y), y), groupArray(act), groupArray(msg_milli_timestamp))) :: 7) -> arrayMap(lambda(tuple(x, y), if(and(equals(x, 'send_msg'), equals(arrayElement(arraySort(lambda(tuple(x, y), y), groupArray(act), groupArray(msg_milli_timestamp)), minus(y, 1)), 'recv_msg')), 1, 0)), arraySort(lambda(tuple(x, y), y), groupArray(act), groupArray(msg_milli_timestamp)), arrayEnumerate(arraySort(lambda(tuple(x, y), y), groupArray(act), groupArray(msg_milli_timestamp)))) Array(UInt8) : 12'