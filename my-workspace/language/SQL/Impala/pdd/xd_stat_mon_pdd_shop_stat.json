[
  {
    "name": "mon_pdd_shop_stat",
    "impala": {
      "host": "zjk-bigdata005",
      "sql": "SELECT cast (replace(`date`, '-', '') as int ) as `date`, replace(xd_shop_nick, 'cnpdd', '' ) as nick, received_pv AS `robot.config2_ask_count`, identified_pv AS `robot.identify_count`, auto_reply_pv AS `robot.answer_auto_send_count`,        click_reply_pv as `robot.answer_manual_adopt_count`, valid_pv as `robot.config2_valid_use_count`,round(valid_pv/received_pv, 4) * 100 as `robot.config2_valid_use_percent`  FROM app_mp.msg_day_platform_nick WHERE `date` = '{{ get_days_str(0, '-') }}' AND platform = 'pdd'",
      "fmt_cols": {
        "object_id_cols": [],
        "datetime_col": [],
        "selector_cols": ["date", "nick"],
        "data_cols": [
          "date", 
          "nick", 
          "robot.config2_ask_count", 
          "robot.identify_count", 
          "robot.answer_auto_send_count", 
          "robot.answer_manual_adopt_count",
          "robot.config2_valid_use_count",
          "robot.config2_valid_use_percent"
        ]
      }
    },
    "mongo": {
      "uri": "mongodb://xdmp:20E6QK8V@47.96.70.30:27017",
      "db": "xd_stat",
      "collection": "mon_pdd_shop_stat",
      "batch_size": 3000
    }
  }
,

    {
    "name": "mon_pdd_shop_stat",
    "impala": {
      "host": "zjk-bigdata005",
      "sql": "SELECT cast (replace(`date`, '-', '') as int ) as `date`, replace(xd_shop_nick, 'cnpdd', '' ) as nick, serve_cuv as `robot.config2_cnick_count` FROM app_mp.msg_day_platform_nick WHERE `date` = '{{ get_days_str(0, '-') }}' AND platform = 'pdd' ",
      "fmt_cols": {
        "object_id_cols": [],
        "datetime_col": [],
        "selector_cols": ["date", "nick"],
        "data_cols": [
          "date", 
          "nick", 
          "robot.config2_cnick_count"
        ]
      }
    },
    "mongo": {
      "uri": "mongodb://xdmp:20E6QK8V@47.96.70.30:27017",
      "db": "xd_stat",
      "collection": "mon_pdd_shop_stat",
      "batch_size": 3000
    }
  }
]



