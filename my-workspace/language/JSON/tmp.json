province
city
gdp

row_number() over(partition by province order by gdp desc)


SELECT city, gdp, gdp/
FROM gdp_table
INNER JOIN (
  SELECT province, sum(gdp)
  FROM gdp_table
  GROUP BY province
) AS t

